!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.allsensors={})}(this,function(t){"use strict";var e=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)},i="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n="object"==typeof i&&i&&i.Object===Object&&i,r="object"==typeof self&&self&&self.Object===Object&&self,a=n||r||Function("return this")(),o=function(){return a.Date.now()},s=a.Symbol,c=Object.prototype,l=c.hasOwnProperty,u=c.toString,d=s?s.toStringTag:void 0;var f=function(t){var e=l.call(t,d),i=t[d];try{t[d]=void 0;var n=!0}catch(t){}var r=u.call(t);return n&&(e?t[d]=i:delete t[d]),r},g=Object.prototype.toString;var v=function(t){return g.call(t)},h="[object Null]",y="[object Undefined]",p=s?s.toStringTag:void 0;var m=function(t){return null==t?void 0===t?y:h:p&&p in Object(t)?f(t):v(t)};var b=function(t){return null!=t&&"object"==typeof t},w="[object Symbol]";var z=function(t){return"symbol"==typeof t||b(t)&&m(t)==w},j=NaN,x=/^\s+|\s+$/g,O=/^[-+]0x[0-9a-f]+$/i,T=/^0b[01]+$/i,P=/^0o[0-7]+$/i,S=parseInt;var E=function(t){if("number"==typeof t)return t;if(z(t))return j;if(e(t)){var i="function"==typeof t.valueOf?t.valueOf():t;t=e(i)?i+"":i}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(x,"");var n=T.test(t);return n||P.test(t)?S(t.slice(2),n?2:8):O.test(t)?j:+t},q="Expected a function",M=Math.max,N=Math.min;var A=function(t,i,n){var r,a,s,c,l,u,d=0,f=!1,g=!1,v=!0;if("function"!=typeof t)throw new TypeError(q);function h(e){var i=r,n=a;return r=a=void 0,d=e,c=t.apply(n,i)}function y(t){var e=t-u;return void 0===u||e>=i||e<0||g&&t-d>=s}function p(){var t=o();if(y(t))return m(t);l=setTimeout(p,function(t){var e=i-(t-u);return g?N(e,s-(t-d)):e}(t))}function m(t){return l=void 0,v&&r?h(t):(r=a=void 0,c)}function b(){var t=o(),e=y(t);if(r=arguments,a=this,u=t,e){if(void 0===l)return function(t){return d=t,l=setTimeout(p,i),f?h(t):c}(u);if(g)return l=setTimeout(p,i),h(u)}return void 0===l&&(l=setTimeout(p,i)),c}return i=E(i)||0,e(n)&&(f=!!n.leading,s=(g="maxWait"in n)?M(E(n.maxWait)||0,i):s,v="trailing"in n?!!n.trailing:v),b.cancel=function(){void 0!==l&&clearTimeout(l),d=0,r=u=a=l=void 0},b.flush=function(){return void 0===l?c:m(o())},b},L="Expected a function";var k=function(t,i,n){var r=!0,a=!0;if("function"!=typeof t)throw new TypeError(L);return e(n)&&(r="leading"in n?!!n.leading:r,a="trailing"in n?!!n.trailing:a),A(t,i,{leading:r,maxWait:i,trailing:a})};class C{constructor(){this.state={}}initialize({queryPeriod:t}={}){void 0!==t&&null!==t||(t=0),this.queryPeriod=t;const e={state:this.state,queryPeriod:t,throttlify:0===t?t=>t:this.throttlify.bind(this)};return new I(e).initialize(),new $(e).initialize(),new B(e).initialize(),new D(e).initialize(),new G(e).initialize(),new W(e).initialize(),new R(e).initialize(),new V(e).initialize(),this}throttlify(t){return k(t,this.queryPeriod)}}class I{constructor(t){Object.assign(this,t)}initialize(){navigator.getBattery&&navigator.getBattery().then(t=>{this.state.battery=t,t.addEventListener("chargingchange",()=>{this.state.battery=t})})}}class ${constructor(t){Object.assign(this,t)}initialize(){navigator.geolocation&&navigator.geolocation.watchPosition(t=>{this.state.geo=t},()=>void 0,{enableHighAccuracy:!0,timeout:this.queryPeriod,maximumAge:0})}}class B{constructor(t){Object.assign(this,t)}initialize(){window.addEventListener("deviceorientation",this.throttlify(t=>{this.state.deviceorientation=t}),!1)}}class D{constructor(t){Object.assign(this,t)}initialize(){window.addEventListener("devicemotion",this.throttlify(t=>{this.state.devicemotion=t}),!1)}}class G{constructor(t){Object.assign(this,t)}initialize(){window.addEventListener("devicelight",this.throttlify(t=>{this.state.devicelight=t}),!1)}}class W{constructor(t){Object.assign(this,t)}initialize(){window.addEventListener("deviceproximity",this.throttlify(t=>{this.state.deviceproximity=t}),!1)}}class R{constructor(t){Object.assign(this,t)}initialize(){if("AmbientLightSensor"in window){const t=new window.AmbientLightSensor;t.onreading=(()=>{this.state.lightlevel=t}),t.onerror=(t=>{console.error("No light sensor",t.error.name,t.error.message)}),t.start()}}}class V{constructor(t){Object.assign(this,t)}initialize(){setTimeout(()=>{this.state.navigator=navigator},this.queryPeriod)}}function _(t){const e={};return t.battery&&(e.battery=U(t.battery)),t.geo&&(e.geo=J(t.geo)),t.deviceorientation&&(e.deviceorientation=K(t.deviceorientation)),t.devicemotion&&(e.devicemotion=F(t.devicemotion)),t.navigator&&(e.navigator=H(t.navigator)),e}function F({acceleration:t,accelerationIncludingGravity:e,interval:i,rotationRate:n,timeStamp:r}){return{acceleration:{x:t.x,y:t.y,z:t.z},accelerationIncludingGravity:{x:e.x,y:e.y,z:e.z},interval:i,rotationRate:{alpha:n.alpha,beta:n.beta,gamma:n.gamma},timeStamp:r}}function H({appCodeName:t,appVersion:e,deviceMemory:i,hardwareConcurrency:n,appName:r,languages:a,language:o,platform:s,product:c,userAgent:l,vendor:u,connection:d}){return{appCodeName:t,appVersion:e,deviceMemory:i,hardwareConcurrency:n,appName:r,languages:a,language:o,platform:s,product:c,userAgent:l,vendor:u,connection:d?{downlink:d.downlink,downlinkMax:d.downlinkMax,effectiveType:d.effectiveType,type:d.type}:null}}function U({charging:t,chargingTime:e,dischargingTime:i,level:n}){return{charging:t,chargingTime:e,dischargingTime:i,level:n}}function J({coords:t}){const{latitude:e,longitude:i,altitude:n,accuracy:r,speed:a,altitudeAccuracy:o,heading:s}=t;return{coords:{latitude:e,longitude:i,altitude:n,accuracy:r,speed:a,altitudeAccuracy:o,heading:s}}}function K({alpha:t,beta:e,gamma:i,absolute:n,bubbles:r,timeStamp:a}){return{alpha:t,beta:e,gamma:i,absolute:n,bubbles:r,timeStamp:a}}class Q{constructor(t,e,i){this.listeners=[],t&&t.queryPeriod&&(this.queryPeriod=t.queryPeriod);const n=e.initialize(this.queryPeriod);this.serialize=i.bind(this),setInterval(()=>{const t=n.state;this.listeners.forEach(e=>e.call(null,t))},this.queryPeriod)}listen(t){this.listeners.push(t)}clearListeners(){this.listeners=[]}}t.GlobalSensor=class extends Q{constructor(t){super(t,new C,_)}},t.serializeState=_,t.serializeBatteryManager=U,t.serializePosition=J,t.serializeDeviceOrientationEvent=K,t.serializeDeviceMotionEvent=F,t.serializeNavigator=H,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=index.js.map
