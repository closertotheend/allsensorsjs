!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.allsensors={})}(this,function(e){"use strict";var t=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},i="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n="object"==typeof i&&i&&i.Object===Object&&i,r="object"==typeof self&&self&&self.Object===Object&&self,o=n||r||Function("return this")(),a=function(){return o.Date.now()},s=o.Symbol,c=Object.prototype,u=c.hasOwnProperty,l=c.toString,d=s?s.toStringTag:void 0;var g=function(e){var t=u.call(e,d),i=e[d];try{e[d]=void 0;var n=!0}catch(e){}var r=l.call(e);return n&&(t?e[d]=i:delete e[d]),r},f=Object.prototype.toString;var v=function(e){return f.call(e)},p="[object Null]",h="[object Undefined]",y=s?s.toStringTag:void 0;var m=function(e){return null==e?void 0===e?h:p:y&&y in Object(e)?g(e):v(e)};var b=function(e){return null!=e&&"object"==typeof e},w="[object Symbol]";var x=function(e){return"symbol"==typeof e||b(e)&&m(e)==w},L=NaN,j=/^\s+|\s+$/g,P=/^[-+]0x[0-9a-f]+$/i,T=/^0b[01]+$/i,S=/^0o[0-7]+$/i,q=parseInt;var E=function(e){if("number"==typeof e)return e;if(x(e))return L;if(t(e)){var i="function"==typeof e.valueOf?e.valueOf():e;e=t(i)?i+"":i}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(j,"");var n=T.test(e);return n||S.test(e)?q(e.slice(2),n?2:8):P.test(e)?L:+e},O="Expected a function",z=Math.max,M=Math.min;var N=function(e,i,n){var r,o,s,c,u,l,d=0,g=!1,f=!1,v=!0;if("function"!=typeof e)throw new TypeError(O);function p(t){var i=r,n=o;return r=o=void 0,d=t,c=e.apply(n,i)}function h(e){var t=e-l;return void 0===l||t>=i||t<0||f&&e-d>=s}function y(){var e=a();if(h(e))return m(e);u=setTimeout(y,function(e){var t=i-(e-l);return f?M(t,s-(e-d)):t}(e))}function m(e){return u=void 0,v&&r?p(e):(r=o=void 0,c)}function b(){var e=a(),t=h(e);if(r=arguments,o=this,l=e,t){if(void 0===u)return function(e){return d=e,u=setTimeout(y,i),g?p(e):c}(l);if(f)return u=setTimeout(y,i),p(l)}return void 0===u&&(u=setTimeout(y,i)),c}return i=E(i)||0,t(n)&&(g=!!n.leading,s=(f="maxWait"in n)?z(E(n.maxWait)||0,i):s,v="trailing"in n?!!n.trailing:v),b.cancel=function(){void 0!==u&&clearTimeout(u),d=0,r=l=o=u=void 0},b.flush=function(){return void 0===u?c:m(a())},b},A="Expected a function";var k=function(e,i,n){var r=!0,o=!0;if("function"!=typeof e)throw new TypeError(A);return t(n)&&(r="leading"in n?!!n.leading:r,o="trailing"in n?!!n.trailing:o),N(e,i,{leading:r,maxWait:i,trailing:o})};class C{constructor({queryPeriod:e,state:t}={state:{}}){return this.state=t,void 0!==e&&null!==e||(e=0),this.throttlify=0===e?e=>e:k.bind(this,void 0,this.queryPeriod),this.beginListening(),this}beginListening(){}}class I extends C{constructor(){super()}beginListening(){const e={state:this.state,queryPeriod:this.queryPeriod};new $(e),new B(e),new D(e),new G(e),new W(e),new R(e),new V(e),new _(e)}}class $ extends C{constructor(e){super(e)}beginListening(){navigator.getBattery&&navigator.getBattery().then(e=>{this.state.battery=e,e.addEventListener("chargingchange",()=>{this.state.battery=e})})}}class B extends C{constructor(e){super(e)}beginListening(){navigator.geolocation&&navigator.geolocation.watchPosition(e=>{this.state.geo=e},()=>void 0,{enableHighAccuracy:!0,timeout:this.queryPeriod,maximumAge:0})}}class D extends C{constructor(e){super(e)}beginListening(){window.addEventListener("deviceorientation",this.throttlify(e=>{this.state.deviceorientation=e}),!1)}}class G extends C{constructor(e){super(e)}beginListening(){window.addEventListener("devicemotion",this.throttlify(e=>{this.state.devicemotion=e}),!1)}}class W extends C{constructor(e){super(e)}beginListening(){window.addEventListener("devicelight",this.throttlify(e=>{this.state.devicelight=e}),!1)}}class R extends C{constructor(e){super(e)}beginListening(){window.addEventListener("deviceproximity",this.throttlify(e=>{this.state.deviceproximity=e}),!1)}}class V extends C{constructor(e){super(e)}beginListening(){if("AmbientLightSensor"in window){const e=new window.AmbientLightSensor;e.onreading=(()=>{this.state.lightlevel=e}),e.onerror=(e=>{console.error("No light sensor",e.error.name,e.error.message)}),e.start()}}}class _ extends C{constructor(e){super(e)}beginListening(){setTimeout(()=>{this.state.navigator=navigator},this.queryPeriod)}}function F(e){const t={};return e.battery&&(t.battery=J(e.battery)),e.geo&&(t.geo=K(e.geo)),e.deviceorientation&&(t.deviceorientation=Q(e.deviceorientation)),e.devicemotion&&(t.devicemotion=H(e.devicemotion)),e.navigator&&(t.navigator=U(e.navigator)),t}function H({acceleration:e,accelerationIncludingGravity:t,interval:i,rotationRate:n,timeStamp:r}){return{acceleration:{x:e.x,y:e.y,z:e.z},accelerationIncludingGravity:{x:t.x,y:t.y,z:t.z},interval:i,rotationRate:{alpha:n.alpha,beta:n.beta,gamma:n.gamma},timeStamp:r}}function U({appCodeName:e,appVersion:t,deviceMemory:i,hardwareConcurrency:n,appName:r,languages:o,language:a,platform:s,product:c,userAgent:u,vendor:l,connection:d}){return{appCodeName:e,appVersion:t,deviceMemory:i,hardwareConcurrency:n,appName:r,languages:o,language:a,platform:s,product:c,userAgent:u,vendor:l,connection:d?{downlink:d.downlink,downlinkMax:d.downlinkMax,effectiveType:d.effectiveType,type:d.type}:null}}function J({charging:e,chargingTime:t,dischargingTime:i,level:n}){return{charging:e,chargingTime:t,dischargingTime:i,level:n}}function K({coords:e}){const{latitude:t,longitude:i,altitude:n,accuracy:r,speed:o,altitudeAccuracy:a,heading:s}=e;return{coords:{latitude:t,longitude:i,altitude:n,accuracy:r,speed:o,altitudeAccuracy:a,heading:s}}}function Q({alpha:e,beta:t,gamma:i,absolute:n,bubbles:r,timeStamp:o}){return{alpha:e,beta:t,gamma:i,absolute:n,bubbles:r,timeStamp:o}}class X{constructor({queryPeriod:e}={},t,i){this.listeners=[],e&&(this.queryPeriod=opts.queryPeriod);const n=new t({queryPeriod:this.queryPeriod});this.serialize=i.bind(this),setInterval(()=>{const e=n.state;this.listeners.forEach(t=>t.call(null,e))},this.queryPeriod)}listen(e){this.listeners.push(e)}clearListeners(){this.listeners=[]}}e.GlobalSensor=class extends X{constructor(e){super(e,I,F)}},e.serializeState=F,e.serializeBatteryManager=J,e.serializePosition=K,e.serializeDeviceOrientationEvent=Q,e.serializeDeviceMotionEvent=H,e.serializeNavigator=U,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=index.js.map
